@{
    ViewData["Title"] = "Test Details (New UI)";
    var testId = (int)ViewBag.TestId;
}
<div class="container mt-4">
    <h2>Деталі тесту (Новий інтерфейс)</h2>
    <p>Використовуємо усі поля останнього API (v2).</p>
    <div id="new-details" class="mt-3">
        <div><strong>Id:</strong> <span id="new-id"></span></div>
        <div><strong>Name:</strong> <span id="new-name"></span></div>
        <div><strong>Description:</strong> <span id="new-desc"></span></div>
        <div><strong>Teacher:</strong> <span id="new-teacher"></span></div>
        <div><strong>Questions:</strong> <span id="new-qcount"></span></div>
        <div><strong>Total Max Score:</strong> <span id="new-max"></span></div>
        <div><strong>Created At (UTC):</strong> <span id="new-created"></span></div>
        <div><strong>Valid Until (UTC):</strong> <span id="new-valid"></span></div>
    </div>
</div>
<script>
(async function(){
  try {
    const id = @testId;
    const res = await fetch(`/api/v2/tests/${id}`);
    if(!res.ok) throw new Error('API error ' + res.status);
    const data = await res.json();
    document.getElementById('new-id').textContent = data.id;
    document.getElementById('new-name').textContent = data.name;
    document.getElementById('new-desc').textContent = data.description;
    document.getElementById('new-teacher').textContent = `${data.teacherName} (ID: ${data.teacherId})`;
    document.getElementById('new-qcount').textContent = data.questionCount;
    document.getElementById('new-max').textContent = data.totalMaxScore;
    document.getElementById('new-created').textContent = data.createdAt;
    document.getElementById('new-valid').textContent = data.validUntil ?? '-';
  } catch(e){
    console.error(e);
  }
})();
</script>
